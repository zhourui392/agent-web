# Agent Web 页面功能验证指南

## 服务启动

```bash
# 启动服务
mvn spring-boot:run

# 访问地址
http://localhost:18092
```

## 功能验证清单

### 1. 认证模块

| 功能 | 页面 | 验证步骤 | 预期结果 |
|------|------|----------|----------|
| 登录页面 | `/login.html` | 访问登录页 | 显示用户名、密码输入框和登录按钮 |
| 用户登录 | `/login.html` | 输入 admin / Zz135246!@#$ 点击登录 | 提示"登录成功"，跳转到主页 |
| 登录失败 | `/login.html` | 输入错误密码 | 提示"用户名或密码错误" |
| 表单验证 | `/login.html` | 不输入用户名/密码直接登录 | 显示必填提示 |
| 登录状态检查 | `/index.html` | 未登录直接访问主页 | 自动跳转到登录页 |
| 退出登录 | `/index.html` | 点击"退出登录"按钮 | 提示"已退出登录"，跳转到登录页 |

### 2. 文件系统模块

| 功能 | 页面位置 | 验证步骤 | 预期结果 |
|------|----------|----------|----------|
| 根路径列表 | 左侧边栏-工作目录 | 登录后查看根路径下拉框 | 显示配置的根路径列表 |
| 切换根路径 | 左侧边栏-工作目录 | 选择不同根路径 | 当前路径更新，目录列表刷新 |
| 目录浏览 | 左侧边栏-目录列表 | 点击子目录 | 进入子目录，显示其子目录列表 |
| 返回上级 | 左侧边栏-目录列表 | 点击 ".." | 返回上级目录 |
| 当前路径显示 | 左侧边栏-当前路径 | 切换目录 | 实时显示当前完整路径 |

### 3. 会话管理模块

| 功能 | 页面位置 | 验证步骤 | 预期结果 |
|------|----------|----------|----------|
| 启动会话 | 左侧边栏-Agent设置 | 选择目录后点击"启动会话" | 显示会话ID、Agent类型、工作目录 |
| 会话信息展示 | 左侧边栏-Agent设置 | 启动会话后 | 显示会话ID、Agent、目录、Resume ID |
| 清除上下文 | 左侧边栏-Agent设置 | 点击"清除上下文" | 提示"上下文已清除"，Resume ID 清空 |
| 目录不存在 | 左侧边栏-Agent设置 | 选择不存在的目录启动会话 | 提示"Working directory not found" |

### 4. 聊天交互模块

| 功能 | 页面位置 | 验证步骤 | 预期结果 |
|------|----------|----------|----------|
| 发送消息 | 右侧聊天区 | 输入消息点击"发送"或按 Enter | 消息显示在右侧蓝色气泡 |
| 接收响应 | 右侧聊天区 | 发送消息后等待 | Agent 响应显示在左侧白色气泡 |
| 流式输出 | 右侧聊天区 | 发送消息观察响应 | 响应内容逐步显示（SSE 流式） |
| 换行输入 | 右侧输入框 | 按 Ctrl+Enter | 输入框内换行 |
| 进程退出 | 右侧聊天区 | 等待 Agent 完成 | 显示"进程退出码: 0" |
| 上下文续接 | 右侧聊天区 | 连续发送多条消息 | Resume ID 保持，上下文连续 |
| 禁用状态 | 右侧输入框 | 未启动会话时 | 输入框和发送按钮禁用 |

### 5. 用户界面

| 功能 | 页面位置 | 验证步骤 | 预期结果 |
|------|----------|----------|----------|
| 用户信息 | 左侧边栏-用户信息 | 登录后查看 | 显示当前登录用户名 |
| 消息滚动 | 右侧聊天区 | 发送多条消息 | 自动滚动到最新消息 |
| 加载状态 | 发送按钮 | 发送消息时 | 按钮显示加载状态 |
| 系统消息 | 右侧聊天区 | 启动会话/清除上下文 | 绿色系统消息提示 |
| 错误消息 | 右侧聊天区 | 发生错误时 | 红色错误消息提示 |

## API 接口清单

| 接口 | 方法 | 路径 | 说明 |
|------|------|------|------|
| 登录 | POST | `/api/auth/login` | 用户登录认证 |
| 登出 | POST | `/api/auth/logout` | 退出登录 |
| 检查登录 | GET | `/api/auth/check` | 检查登录状态 |
| 获取根路径 | GET | `/api/fs/roots` | 获取允许的根路径列表 |
| 列出目录 | GET | `/api/fs/list?path=xxx` | 列出指定路径下的子目录 |
| 创建会话 | POST | `/api/chat/session` | 创建 Agent 会话 |
| 发送消息 | POST | `/api/chat/session/{id}/message` | 同步发送消息 |
| 流式消息 | GET | `/api/chat/session/{id}/message/stream` | SSE 流式发送消息 |

## 快速验证流程

1. 启动服务：`mvn spring-boot:run`
2. 访问 http://localhost:18092/login.html
3. 输入 admin / Zz135246!@#$ 登录
4. 选择工作目录（如 agent-web）
5. 点击"启动会话"
6. 在输入框输入指令（如"列出当前目录下的文件"）
7. 点击发送，观察 Agent 响应
8. 验证完成后点击"退出登录"
